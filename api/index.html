<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SecLAB Alpha v5.0 | Enterprise SOC HUD</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=Fira+Code:wght@300;400;500&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --accent: #0ea5e9;
            --danger: #ef4444;
            --success: #22c55e;
            --zinc-950: #09090b;
            --zinc-900: #18181b;
            --zinc-800: #27272a;
        }

        body {
            font-family: 'Space Grotesk', sans-serif;
            background-color: var(--zinc-950);
            color: #a1a1aa;
        }

        .mono {
            font-family: 'Fira Code', monospace;
        }

        .glass {
            background: rgba(24, 24, 27, 0.8);
            backdrop-filter: blur(24px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .sidebar-active {
            background: rgba(14, 165, 233, 0.1);
            border-right: 3px solid var(--accent);
            color: #fff;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.4s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .matrix-grid {
            background-image: radial-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px);
            background-size: 32px 32px;
        }

        .shimmer {
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.03), transparent);
            background-size: 200% 100%;
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% {
                background-position: 200% 0;
            }

            100% {
                background-position: -200% 0;
            }
        }

        .custom-scroll::-webkit-scrollbar {
            width: 4px;
        }

        .custom-scroll::-webkit-scrollbar-thumb {
            background: var(--zinc-800);
            border-radius: 10px;
        }

        .node-pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(14, 165, 233, 0.4);
            }

            70% {
                box-shadow: 0 0 0 10px rgba(14, 165, 233, 0);
            }

            100% {
                box-shadow: 0 0 0 0 rgba(14, 165, 233, 0);
            }
        }
    </style>
</head>

<body class="overflow-hidden select-none matrix-grid">

    <!-- OVERLAYS -->
    <div id="conn-lost"
        class="fixed inset-0 z-[200] bg-zinc-950/95 backdrop-blur-xl hidden flex flex-col items-center justify-center p-12 text-center">
        <div
            class="w-20 h-20 rounded-full bg-red-500/10 flex items-center justify-center border border-red-500/30 mb-8 node-pulse">
            <i data-lucide="wifi-off" class="text-red-500 w-10 h-10"></i>
        </div>
        <h2 class="text-3xl font-bold text-white mb-3 uppercase tracking-tighter">Connection Interrupted</h2>
        <p class="text-zinc-500 max-w-sm text-lg">Re-establishing autonomous link with SecLAB Core Central...</p>
        <button onclick="window.location.reload()"
            class="mt-10 px-8 py-3 bg-zinc-800 hover:bg-zinc-700 text-white rounded-xl font-bold transition">Manual
            Override</button>
    </div>

    <!-- MAIN HUD -->
    <div class="flex h-screen w-full relative">

        <!-- SIDENAV -->
        <aside class="w-72 glass border-r border-white/5 flex flex-col z-50">
            <div class="p-8 border-b border-white/5">
                <div class="flex items-center gap-4">
                    <div
                        class="w-10 h-10 bg-sky-500 rounded-xl flex items-center justify-center shadow-lg shadow-sky-900/40">
                        <i data-lucide="shield-check" class="text-white w-6 h-6"></i>
                    </div>
                    <div>
                        <h1 class="text-white font-black text-xl tracking-tighter italic">SecLAB <span
                                class="text-sky-500 font-sans">Î±</span></h1>
                        <p class="text-[9px] font-black text-zinc-600 uppercase tracking-widest">Enterprise SOC</p>
                    </div>
                </div>
            </div>

            <nav class="flex-1 py-8 custom-scroll overflow-y-auto">
                <p class="px-8 text-[10px] font-bold text-zinc-700 uppercase tracking-[0.3em] mb-4">Command Hub</p>
                <button onclick="switchTab('dashboard')" id="nav-dashboard"
                    class="nav-btn w-full flex items-center gap-4 px-8 py-3.5 hover:bg-white/5 transition group sidebar-active">
                    <i data-lucide="layout" class="w-4 h-4 group-hover:text-sky-500"></i> <span
                        class="font-bold text-sm">Dashboard</span>
                </button>
                <button onclick="switchTab('vulnerabilities')" id="nav-vulnerabilities"
                    class="nav-btn w-full flex items-center gap-4 px-8 py-3.5 hover:bg-white/5 transition group">
                    <i data-lucide="database" class="w-4 h-4 group-hover:text-sky-500"></i> <span
                        class="font-bold text-sm">Vulnerability Bank</span>
                </button>
                <button onclick="switchTab('patch-lab')" id="nav-patch-lab"
                    class="nav-btn w-full flex items-center gap-4 px-8 py-3.5 hover:bg-white/5 transition group">
                    <i data-lucide="wand-2" class="w-4 h-4 group-hover:text-sky-500"></i> <span
                        class="font-bold text-sm">AI Remediation</span>
                </button>

                <p class="px-8 text-[10px] font-bold text-zinc-700 uppercase tracking-[0.3em] mt-10 mb-4">Deep Logic</p>
                <button onclick="switchTab('risk')" id="nav-risk"
                    class="nav-btn w-full flex items-center gap-4 px-8 py-3.5 hover:bg-white/5 transition group">
                    <i data-lucide="target" class="w-4 h-4 group-hover:text-sky-500"></i> <span
                        class="font-bold text-sm">Risk Assessment</span>
                </button>
                <button onclick="switchTab('logic')" id="nav-logic"
                    class="nav-btn w-full flex items-center gap-4 px-8 py-3.5 hover:bg-white/5 transition group">
                    <i data-lucide="webhook" class="w-4 h-4 group-hover:text-sky-500"></i> <span
                        class="font-bold text-sm">Decision Trees</span>
                </button>
                <button onclick="switchTab('forensics')" id="nav-forensics"
                    class="nav-btn w-full flex items-center gap-4 px-8 py-3.5 hover:bg-white/5 transition group">
                    <i data-lucide="glasses" class="w-4 h-4 group-hover:text-sky-500"></i> <span
                        class="font-bold text-sm">Code Forensics</span>
                </button>

                <p class="px-8 text-[10px] font-bold text-zinc-700 uppercase tracking-[0.3em] mt-10 mb-4">Governance</p>
                <button onclick="switchTab('reports')" id="nav-reports"
                    class="nav-btn w-full flex items-center gap-4 px-8 py-3.5 hover:bg-white/5 transition group">
                    <i data-lucide="file-check" class="w-4 h-4 group-hover:text-sky-500"></i> <span
                        class="font-bold text-sm">Compliance Logs</span>
                </button>
                <button onclick="switchTab('network')" id="nav-network"
                    class="nav-btn w-full flex items-center gap-4 px-8 py-3.5 hover:bg-white/5 transition group">
                    <i data-lucide="network" class="w-4 h-4 group-hover:text-sky-500"></i> <span
                        class="font-bold text-sm">Infrastructure</span>
                </button>
                <button onclick="switchTab('engine')" id="nav-engine"
                    class="nav-btn w-full flex items-center gap-4 px-8 py-3.5 hover:bg-white/5 transition group">
                    <i data-lucide="cpu" class="w-4 h-4 group-hover:text-sky-500"></i> <span
                        class="font-bold text-sm">Engine Core</span>
                </button>
                <button onclick="switchTab('audit')" id="nav-audit"
                    class="nav-btn w-full flex items-center gap-4 px-8 py-3.5 hover:bg-white/5 transition group">
                    <i data-lucide="terminal" class="w-4 h-4 group-hover:text-sky-500"></i> <span
                        class="font-bold text-sm">Audit Stream</span>
                </button>
            </nav>

            <div class="p-6">
                <div class="p-5 bg-zinc-900 rounded-2xl border border-white/5 relative group overflow-hidden">
                    <div class="absolute inset-0 shimmer opacity-30 pointer-events-none"></div>
                    <div class="flex items-center gap-3 mb-3 relative z-10">
                        <div class="w-2 h-2 rounded-full bg-green-500"></div>
                        <span class="text-[10px] font-black text-white uppercase tracking-widest">Core Status:
                            Stable</span>
                    </div>
                    <div class="flex justify-between items-center text-[9px] font-mono text-zinc-600 relative z-10">
                        <span id="uptime-clock">00:00:00</span>
                        <span>v5.0-SOC</span>
                    </div>
                </div>
            </div>
        </aside>

        <!-- MAIN VIEWPORT -->
        <main class="flex-1 flex flex-col min-w-0">

            <!-- TOOLBAR -->
            <header class="h-20 glass border-b border-white/5 flex items-center justify-between px-10 relative z-40">
                <div class="flex items-center gap-6">
                    <div class="w-1.5 h-6 bg-sky-500 rounded-full"></div>
                    <div>
                        <h2 id="tab-label" class="text-xl font-black text-white tracking-widest uppercase italic">
                            Operational_Alerts</h2>
                    </div>
                </div>
                <div class="flex items-center gap-6">
                    <div id="retry-badge"
                        class="hidden flex items-center gap-2 px-4 py-1.5 bg-red-500/10 border border-red-500/20 rounded-full">
                        <span class="w-1.5 h-1.5 bg-red-500 rounded-full animate-ping"></span>
                        <span class="text-[9px] font-black text-red-500 uppercase">Signal Loss...</span>
                    </div>
                    <button onclick="runGlobalDiagnostic()"
                        class="group relative px-6 py-2.5 bg-sky-600 hover:bg-sky-500 text-white rounded-xl overflow-hidden transition-all shadow-lg active:scale-95">
                        <div class="flex items-center gap-2 relative z-10">
                            <i data-lucide="zap" class="w-4 h-4"></i>
                            <span class="text-[10px] font-black uppercase tracking-widest">Execute Scan</span>
                        </div>
                    </button>
                    <div
                        class="w-10 h-10 rounded-xl bg-zinc-900 border border-white/10 flex items-center justify-center cursor-pointer hover:bg-zinc-800 transition">
                        <i data-lucide="bell" class="w-4 h-4 text-zinc-500"></i>
                    </div>
                </div>
            </header>

            <!-- TAB VIEWS -->
            <div class="flex-1 overflow-y-auto p-12 custom-scroll relative bg-zinc-950/40">

                <!-- 1. DASHBOARD -->
                <section id="tab-dashboard" class="tab-content active space-y-12">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                        <div
                            class="lg:col-span-2 p-10 bg-zinc-900/50 rounded-[2.5rem] border border-white/5 flex items-center gap-12 relative overflow-hidden">
                            <div class="absolute -right-20 -bottom-20 opacity-5 pointer-events-none">
                                <i data-lucide="shield" class="w-80 h-80 text-white"></i>
                            </div>
                            <div
                                class="shrink-0 w-36 h-36 rounded-full border-[10px] border-zinc-900 flex items-center justify-center relative shadow-[inset_0_0_50px_rgba(0,0,0,0.5)] bg-zinc-950">
                                <span class="text-4xl font-black text-white" id="dash-health">--</span>
                                <svg class="absolute inset-0 -rotate-90 w-36 h-36">
                                    <circle cx="72" cy="72" r="62" fill="transparent" stroke="currentColor"
                                        stroke-width="10" class="text-zinc-800"></circle>
                                    <circle id="health-ring" cx="72" cy="72" r="62" fill="transparent"
                                        stroke="currentColor" stroke-width="10" stroke-dasharray="390"
                                        stroke-dashoffset="390" class="text-sky-500 transition-all duration-1000">
                                    </circle>
                                </svg>
                            </div>
                            <div>
                                <p class="text-[11px] font-black text-sky-500 uppercase tracking-[0.4em] mb-3">Overall
                                    Health Score</p>
                                <h3 class="text-white text-3xl font-black tracking-tighter mb-4">Infrastructure
                                    Protected</h3>
                                <p class="text-zinc-500 text-sm leading-relaxed max-w-sm">Autonomous logic gates are
                                    correctly filtering 98.4% of high-risk signatures in the current kernel loop.</p>
                            </div>
                        </div>
                        <div
                            class="p-10 bg-zinc-900/50 rounded-[2.5rem] border border-white/5 flex flex-col justify-center">
                            <p class="text-[10px] font-bold text-zinc-600 uppercase tracking-widest mb-4">Detected
                                Vulnerabilities</p>
                            <h2 class="text-5xl font-black text-white" id="dash-total">--</h2>
                            <div class="mt-4 flex gap-2"><span
                                    class="px-2 py-0.5 bg-red-500/10 text-red-500 text-[8px] font-bold rounded">LIVE_DATA</span>
                            </div>
                        </div>
                        <div
                            class="p-10 bg-zinc-900/50 rounded-[2.5rem] border border-white/5 flex flex-col justify-center">
                            <p class="text-[10px] font-bold text-zinc-600 uppercase tracking-widest mb-4">AI Patch
                                Efficiency</p>
                            <h2 class="text-5xl font-black text-sky-400" id="dash-rate">--%</h2>
                            <div class="mt-4 flex gap-2"><span
                                    class="px-2 py-0.5 bg-sky-500/10 text-sky-500 text-[8px] font-bold rounded">AI_TRUSTED</span>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-10">
                        <div
                            class="lg:col-span-2 p-10 bg-zinc-900/40 rounded-[2.5rem] border border-white/5 h-[400px] flex flex-col">
                            <h4 class="text-white font-black text-[10px] uppercase tracking-widest mb-10 opacity-50">
                                Attack Surface Coverage</h4>
                            <div class="flex-1 min-h-0 relative">
                                <canvas id="mainFlowChart"></canvas>
                            </div>
                        </div>
                        <div class="p-10 bg-zinc-900/40 rounded-[2.5rem] border border-white/5 h-[400px] flex flex-col">
                            <h4 class="text-white font-black text-[10px] uppercase tracking-widest mb-10 opacity-50">
                                Real-Time Event Pulse</h4>
                            <div id="activity-log" class="flex-1 overflow-y-auto custom-scroll space-y-4 pr-2">
                                <!-- Dynamic Logs -->
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 2. VULNERABILITIES -->
                <section id="tab-vulnerabilities" class="tab-content space-y-10">
                    <div class="flex justify-between items-end">
                        <h3 class="text-white text-3xl font-black tracking-tighter uppercase italic">Vulnerability
                            Repository</h3>
                        <div class="flex gap-4">
                            <input type="text" placeholder="Grep metadata..."
                                class="bg-zinc-900 border border-white/5 px-6 py-2.5 rounded-xl text-xs text-white focus:outline-none focus:border-sky-500/40 transition-all w-80 font-bold">
                            <button
                                class="bg-zinc-800 hover:bg-zinc-700 text-white px-5 py-2.5 rounded-xl text-xs font-bold transition">Export
                                CSV</button>
                        </div>
                    </div>
                    <div class="bg-zinc-900/30 rounded-[2.5rem] border border-white/5 overflow-hidden">
                        <table class="w-full text-left">
                            <thead
                                class="bg-zinc-900/80 text-[10px] font-bold text-sky-500 uppercase tracking-[0.2em] border-b border-white/5">
                                <tr>
                                    <th class="px-10 py-6">Vulnerability Signature</th>
                                    <th class="px-10 py-6">Source Context</th>
                                    <th class="px-10 py-6 text-center">Severity</th>
                                    <th class="px-10 py-6 text-center">Status</th>
                                    <th class="px-10 py-6 text-right">Laboratory Link</th>
                                </tr>
                            </thead>
                            <tbody id="vuln-table-body"
                                class="divide-y divide-white/5 text-[12px] font-medium text-zinc-400">
                                <!-- Inventory Items -->
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- 3. AI PATCH LAB -->
                <section id="tab-patch-lab" class="tab-content h-[calc(100vh-280px)]">
                    <div class="grid grid-cols-12 gap-8 h-full">
                        <div
                            class="col-span-3 bg-zinc-900/50 rounded-[2rem] border border-white/5 p-6 flex flex-col overflow-hidden">
                            <h4
                                class="text-white font-black text-[10px] uppercase tracking-widest mb-8 opacity-50 px-2">
                                Remediation Queue</h4>
                            <div id="lab-vuln-list" class="flex-1 overflow-y-auto space-y-4 pr-3 custom-scroll">
                                <!-- Vulnerability Cards -->
                            </div>
                        </div>
                        <div
                            class="col-span-9 bg-zinc-950 rounded-[3rem] border border-white/5 flex flex-col overflow-hidden relative shadow-2xl">
                            <div
                                class="h-16 border-b border-white/5 flex items-center justify-between px-10 bg-zinc-900/20">
                                <div class="flex items-center gap-4">
                                    <div class="flex gap-1.5">
                                        <div class="w-2.5 h-2.5 rounded-full bg-zinc-800"></div>
                                        <div class="w-2.5 h-2.5 rounded-full bg-zinc-800"></div>
                                        <div class="w-2.5 h-2.5 rounded-full bg-zinc-800"></div>
                                    </div>
                                    <span id="editor-filename"
                                        class="text-[11px] font-mono text-zinc-500 font-bold">/sys/core/audit.py</span>
                                </div>
                                <div class="flex gap-4">
                                    <button onclick="approveNeuralPatch()" id="btn-approve"
                                        class="bg-emerald-600 hover:bg-emerald-500 text-white px-6 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all disabled:hidden">Apply
                                        Fix</button>
                                    <button onclick="rejectNeuralPatch()" id="btn-reject"
                                        class="bg-zinc-800 hover:bg-zinc-700 text-zinc-400 px-6 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all disabled:hidden">Reject
                                        Logic</button>
                                </div>
                            </div>
                            <div class="flex-1 flex overflow-hidden">
                                <div id="editor-nums"
                                    class="w-16 bg-zinc-900/30 text-zinc-700 text-right pr-4 py-8 mono text-[11px] border-r border-white/5 select-none">
                                </div>
                                <div id="editor-body"
                                    class="flex-1 overflow-auto mono text-[12px] p-8 leading-relaxed relative whitespace-pre bg-transparent italic text-zinc-500">
                                    <div
                                        class="absolute inset-0 flex flex-col items-center justify-center opacity-10 pointer-events-none">
                                        <i data-lucide="brain-circuit" class="w-20 h-20 mb-4"></i>
                                        <span class="font-bold tracking-[1.5em] uppercase text-xs">Awaiting
                                            Analysis</span>
                                    </div>
                                </div>
                            </div>
                            <!-- Code Warning Tooltip -->
                            <div id="code-alert-box"
                                class="absolute bottom-10 left-10 right-10 glass p-8 rounded-[2rem] border-l-[8px] border-red-500 hidden items-start gap-6 transform translate-y-10 transition duration-500">
                                <i data-lucide="alert-octagon" class="text-red-500 w-6 h-6 shrink-0 mt-1"></i>
                                <div>
                                    <p class="text-white font-black text-sm uppercase tracking-tight mb-1 italic">
                                        Signature Detected</p>
                                    <p id="alert-text-body" class="text-xs text-zinc-400 leading-relaxed max-w-2xl">
                                        Potential buffer overflow detected at L23. AI suggests replacing subprocess call
                                        with safer alternative.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 4. RISK ASSESSMENT -->
                <section id="tab-risk" class="tab-content space-y-10">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-10">
                        <div class="p-12 bg-zinc-900/50 rounded-[2.5rem] border border-white/5 space-y-10">
                            <h4 class="text-white font-black uppercase tracking-widest text-xs opacity-50">Impact
                                Visualization</h4>
                            <div class="grid grid-cols-2 gap-6">
                                <div
                                    class="p-8 bg-zinc-950 rounded-3xl border border-white/5 border-l-4 border-red-500">
                                    <p class="text-[10px] font-bold text-zinc-600 uppercase mb-2">Severity</p>
                                    <h5 class="text-2xl font-black text-white italic">CRITICAL</h5>
                                </div>
                                <div
                                    class="p-8 bg-zinc-950 rounded-3xl border border-white/5 border-l-4 border-sky-500">
                                    <p class="text-[10px] font-bold text-zinc-600 uppercase mb-2">Confidence</p>
                                    <h5 class="text-2xl font-black text-white italic">92%</h5>
                                </div>
                                <div
                                    class="p-8 bg-zinc-950 rounded-3xl border border-white/5 border-l-4 border-amber-500">
                                    <p class="text-[10px] font-bold text-zinc-600 uppercase mb-2">Exposure</p>
                                    <h5 class="text-2xl font-black text-white italic">WIDE</h5>
                                </div>
                                <div class="p-8 bg-zinc-950 rounded-3xl border border-white/5 border-l-4 border-white">
                                    <p class="text-[10px] font-bold text-zinc-600 uppercase mb-2">Complexity</p>
                                    <h5 class="text-2xl font-black text-white italic">LOW</h5>
                                </div>
                            </div>
                        </div>
                        <div
                            class="p-12 bg-zinc-900/50 rounded-[2.5rem] border border-white/5 flex flex-col items-center justify-center space-y-10 text-center relative overflow-hidden">
                            <div class="absolute inset-0 shimmer opacity-10 pointer-events-none"></div>
                            <i data-lucide="target" class="w-20 h-20 text-sky-500/20"></i>
                            <div>
                                <h3
                                    class="text-white text-3xl font-black tracking-tighter mb-4 italic uppercase underline decoration-sky-500/20 underline-offset-8">
                                    Crisis Logic Engine</h3>
                                <p class="text-zinc-500 text-sm leading-relaxed max-w-xs">Normalized security score is
                                    calculated using multi-vector analysis across 12 rule parameters.</p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 5. COMPLIANCE REPORTS -->
                <section id="tab-reports" class="tab-content space-y-10">
                    <div class="flex justify-between items-end">
                        <h3 class="text-white text-3xl font-black tracking-tighter uppercase italic">Executive Audit
                            Vault</h3>
                        <p class="text-[10px] font-bold text-zinc-600 uppercase tracking-widest leading-none">ISO 27001
                            / SOC2 Compliant</p>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" id="reports-grid">
                        <!-- Dynamic Reports Load -->
                    </div>
                </section>

                <!-- 6. NETWORK TOPOGRAPHY -->
                <section id="tab-network" class="tab-content space-y-10">
                    <div
                        class="p-12 bg-zinc-900/50 rounded-[3rem] border border-white/5 h-[600px] flex flex-col relative overflow-hidden">
                        <h4
                            class="text-white font-black text-[10px] uppercase tracking-widest mb-10 opacity-50 relative z-10">
                            Global Edge Topography</h4>
                        <div id="topology-map"
                            class="flex-1 bg-zinc-950/50 rounded-[2rem] border border-white/5 relative z-10 flex items-center justify-center p-10">
                            <!-- Visual Topology -->
                        </div>
                    </div>
                </section>

                <!-- 7. FORENSICS -->
                <section id="tab-forensics" class="tab-content space-y-10">
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-10 h-[600px]">
                        <div
                            class="lg:col-span-2 p-10 bg-zinc-900/50 rounded-[3rem] border border-white/5 flex flex-col overflow-hidden">
                            <h4 class="text-white font-black text-[10px] uppercase tracking-widest mb-8 opacity-50">Deep
                                Metadata Inspector</h4>
                            <div id="forensic-raw-data"
                                class="flex-1 bg-black/50 p-10 rounded-[2rem] font-mono text-[11px] leading-relaxed text-sky-500 overflow-auto border border-white/5 custom-scroll">
                                { "kernel_status": "WAITING_FOR_DATA_SOURCE" }
                            </div>
                        </div>
                        <div
                            class="p-10 bg-zinc-900/50 rounded-[3rem] border border-white/5 flex flex-col justify-center text-center space-y-8">
                            <i data-lucide="fingerprint" class="w-16 h-16 text-zinc-800 mx-auto"></i>
                            <div>
                                <p class="text-white font-bold text-sm mb-2 uppercase italic tracking-tighter">Bitwise
                                    Artifact Trace</p>
                                <p
                                    class="text-[11px] text-zinc-600 leading-relaxed uppercase font-bold tracking-widest">
                                    Digital fingerprinting enabled for all identified signatures.</p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 8. AUDIT STREAM -->
                <section id="tab-audit" class="tab-content space-y-10">
                    <div class="p-12 bg-zinc-950 rounded-[3rem] border border-white/5 font-mono text-[12px] leading-loose space-y-4 h-[70vh] overflow-y-auto custom-scroll"
                        id="audit-terminal-feed">
                        <!-- Audit Lines -->
                    </div>
                </section>

                <!-- 9. ENGINE SPECS -->
                <section id="tab-engine" class="tab-content space-y-10">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" id="engine-specs-grid">
                        <!-- Dynamic Specs -->
                    </div>
                </section>

            </div>

            <!-- FOOTER -->
            <footer class="h-14 glass border-t border-white/5 px-10 flex items-center justify-between relative z-[100]">
                <div class="flex items-center gap-10 overflow-hidden flex-1">
                    <span class="text-sky-500 font-bold uppercase text-[10px] tracking-widest shrink-0 italic">System
                        Feed :</span>
                    <div class="marquee-container flex-1 overflow-hidden whitespace-nowrap">
                        <div id="footer-marquee"
                            class="inline-block text-[10px] font-bold text-zinc-700 uppercase tracking-[0.2em] italic">
                            [CORE_INIT_OK] - [NODE_SYNC: 100%] - [DATABASE_PERSISTENCE: ENGAGED] - [AI_LINK: ACTIVE] -
                            [SENTINEL_MODE: ARMED]
                        </div>
                    </div>
                </div>
                <div class="flex items-center gap-6 ml-10 shrink-0 text-zinc-700 font-bold text-[10px] tracking-widest">
                    <span id="real-clock">00:00:00</span>
                    <i data-lucide="radio" class="w-4 h-4"></i>
                </div>
            </footer>

        </main>
    </div>

    <!-- NOTIFICATIONS -->
    <div id="toast-container" class="fixed top-24 right-10 z-[1000] w-96 space-y-4 pointer-events-none"></div>

    <script>
        // --- GLOBAL STATE ---
        let activeTabId = 'dashboard';
        let mainStatsChart = null;
        let selectedVulnObject = null;
        let scanInProgress = false;
        let failCount = 0;

        // --- APP INITIALIZER ---
        window.addEventListener('load', async () => {
            lucide.createIcons();
            initCharts();
            startMainHeartbeat();

            // Health UI Startup
            updateHealthCircle(0);

            // Initial Sync
            await syncAllData();

            // Continuous Clock
            setInterval(() => {
                document.getElementById('real-clock').innerText = new Date().toLocaleTimeString('en-GB');
                document.getElementById('uptime-clock').innerText = new Date().toLocaleTimeString();
            }, 1000);
        });

        function initCharts() {
            const ctx = document.getElementById('mainFlowChart').getContext('2d');
            mainStatsChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['-6h', '-5h', '-4h', '-3h', '-2h', '-1h', 'NOW'],
                    datasets: [{
                        label: 'Threat Intensity',
                        data: [5, 12, 8, 45, 22, 60, 35],
                        borderColor: '#0ea5e9',
                        borderWidth: 3,
                        pointRadius: 0,
                        tension: 0.4,
                        fill: true,
                        backgroundColor: (context) => {
                            const g = context.chart.ctx.createLinearGradient(0, 0, 0, 300);
                            g.addColorStop(0, 'rgba(14, 165, 233, 0.2)');
                            g.addColorStop(1, 'transparent');
                            return g;
                        }
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { beginAtZero: true, grid: { color: 'rgba(255,255,255,0.02)' }, ticks: { color: '#3f3f46', font: { size: 9, weight: 'bold' } } },
                        x: { grid: { display: false }, ticks: { color: '#3f3f46', font: { size: 9, weight: 'bold' } } }
                    }
                }
            });
        }

        // --- NAVIGATION ENGINE ---
        function switchTab(id) {
            activeTabId = id;
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.getElementById('tab-' + id).classList.add('active');

            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('sidebar-active'));
            document.getElementById('nav-' + id).classList.add('sidebar-active');

            const tabTitles = {
                dashboard: 'Sentinel_Dashboard', vulnerabilities: 'Signature_Repo', 'patch-lab': 'AI_Neural_Studio',
                risk: 'Crisis_Assessment', logic: 'Decision_Matrix', forensics: 'Code_Forensics',
                reports: 'Compliance_Vault', network: 'Edge_Topology', engine: 'Core_Specifications', audit: 'Audit_Terminal'
            };
            document.getElementById('tab-label').innerText = (tabTitles[id] || id).toUpperCase();

            syncAllData();
        }

        // --- DATA SYNCHRONIZATION ---
        async function syncAllData() {
            try {
                const dashRes = await fetch('/dashboard');
                if (!dashRes.ok) throw new Error("SIGNAL_LOSS");
                const dashData = await dashRes.json();

                renderDashboardMetrics(dashData);
                document.getElementById('conn-lost').classList.add('hidden');
                document.getElementById('retry-badge').classList.add('hidden');
                failCount = 0;

                // Tab Specific Data Pulls
                if (activeTabId === 'vulnerabilities') await syncVulnerabilityBank();
                if (activeTabId === 'patch-lab') await syncPatchLaboratory();
                if (activeTabId === 'audit') await syncAuditTerminal();
                if (activeTabId === 'reports') await syncComplianceReports();
                if (activeTabId === 'network') await syncNetworkTopology();
                if (activeTabId === 'engine') await syncEngineSpecs();
                if (activeTabId === 'forensics') updateForensicDetails();

            } catch (err) {
                console.error("DATA_ENGINE_ERROR:", err);
                handleDataFailure();
            }
        }

        function renderDashboardMetrics(data) {
            document.getElementById('dash-health').innerText = data.health_score;
            document.getElementById('dash-total').innerText = data.kpis.total;
            document.getElementById('dash-rate').innerText = data.kpis.success_rate + '%';
            updateHealthCircle(data.health_score);

            // Random Jiggle for chart reality
            mainStatsChart.data.datasets[0].data = mainStatsChart.data.datasets[0].data.map(v => v + (Math.random() - 0.5) * 6);
            mainStatsChart.update();

            // Activity Log
            fetch('/recent-activity').then(r => r.json()).then(res => {
                const log = document.getElementById('activity-log');
                log.innerHTML = res.activity.slice(0, 8).map(item => `
                     <div class="px-6 py-4 bg-zinc-900/80 rounded-2xl border-l-[3px] ${item.includes('FIXED') ? 'border-sky-500' : 'border-zinc-800'} flex items-center justify-between group cursor-default">
                        <div class="flex items-center gap-4">
                            <div class="w-1.5 h-1.5 rounded-full ${item.includes('FIXED') ? 'bg-sky-500' : 'bg-zinc-700'}"></div>
                            <span class="text-[11px] font-bold tracking-tight">${item}</span>
                        </div>
                        <i data-lucide="chevron-right" class="w-3 h-3 opacity-0 group-hover:opacity-100 transition"></i>
                     </div>
                `).join('');
                lucide.createIcons();
            });
        }

        function updateHealthCircle(score) {
            const ring = document.getElementById('health-ring');
            const circumference = 390; // 2 * PI * 62
            const offset = circumference - (score / 100) * circumference;
            ring.style.strokeDashoffset = offset;
        }

        // --- SUB-DATA HYDRATION ---
        async function syncVulnerabilityBank() {
            const res = await fetch('/vulnerabilities');
            const data = await res.json();
            const body = document.getElementById('vuln-table-body');
            body.innerHTML = data.map(v => `
                <tr class="group hover:bg-white/5 transition duration-300">
                    <td class="px-10 py-6">
                        <div class="text-white font-black italic uppercase tracking-tighter">${v.name}</div>
                        <div class="text-[9px] text-zinc-600 mt-1 uppercase font-bold tracking-[0.2em]">${v.id.substring(0, 24)}...</div>
                    </td>
                    <td class="px-10 py-6 font-mono font-bold text-zinc-500">
                         ${v.file_path.split(/[\\/]/).pop()} <span class="text-zinc-700 text-[10px] ml-2">@ L:${v.line_number}</span>
                    </td>
                    <td class="px-10 py-6 text-center">
                         <span class="px-4 py-1.5 rounded-full text-[9px] font-black uppercase tracking-widest border border-current/20 ${v.severity == 'CRITICAL' ? 'text-red-500 bg-red-500/10' : 'text-sky-500 bg-sky-500/10'}">${v.severity}</span>
                    </td>
                    <td class="px-10 py-6 text-center">
                        <span class="text-[10px] font-black uppercase tracking-widest ${v.state == 'FIXED' ? 'text-sky-400' : 'text-zinc-700'}">${v.state}</span>
                    </td>
                    <td class="px-10 py-6 text-right">
                         <button onclick="inspectVulnerability('${v.id}')" class="px-6 py-2 bg-zinc-800 rounded-xl text-[9px] font-black text-white hover:bg-sky-600 transition uppercase tracking-widest flex items-center gap-3 justify-end ml-auto group-hover:translate-x-1 duration-300">Investigate <i data-lucide="crosshair" class="w-3 h-3"></i></button>
                    </td>
                </tr>
            `).join('');
            lucide.createIcons();
        }

        async function syncPatchLaboratory() {
            const res = await fetch('/vulnerabilities');
            const data = await res.json();
            const list = document.getElementById('lab-vuln-list');
            list.innerHTML = data.map(v => `
                <div onclick="inspectVulnerability('${v.id}')" class="p-6 bg-zinc-900 rounded-3xl cursor-pointer transition-all border border-transparent ${selectedVulnObject && selectedVulnObject.id === v.id ? 'border-sky-500 bg-sky-500/5' : 'hover:border-white/10 hover:translate-x-1'}">
                    <div class="flex justify-between items-start mb-3">
                        <span class="text-[9px] font-black text-zinc-600 uppercase tracking-widest">${v.state}</span>
                        <div class="w-2 h-2 rounded-full ${v.severity == 'CRITICAL' ? 'bg-red-500 shadow-lg shadow-red-900/50' : 'bg-zinc-700'}"></div>
                    </div>
                    <h5 class="text-white font-black text-[12px] uppercase tracking-tight italic">${v.name}</h5>
                    <p class="text-[10px] text-zinc-600 mt-2 font-mono truncate">${v.file_path}</p>
                </div>
            `).join('');
            if (data.length > 0 && !selectedVulnObject) inspectVulnerability(data[0].id);
        }

        async function inspectVulnerability(id) {
            switchTab('patch-lab');
            const res = await fetch(`/vulnerabilities/${id}/source`);
            const data = await res.json();
            selectedVulnObject = { id, ...data };

            document.getElementById('editor-filename').innerText = data.file;
            const editor = document.getElementById('editor-body');
            const nums = document.getElementById('editor-nums');

            editor.innerHTML = '';
            nums.innerHTML = '';

            data.content.split('\n').forEach((line, i) => {
                const ln = i + 1;
                const div = document.createElement('div');
                div.className = 'px-6 transition hover:bg-white/5 whitespace-pre min-h-[1.5em]';
                div.textContent = line || ' ';

                if (ln === data.line) {
                    div.classList.add('bg-red-500/10', 'border-l-[4px]', 'border-red-500', 'text-white', 'not-italic');
                    div.innerHTML = `<span class="relative">${div.textContent.trim()}<span class="absolute -left-20 top-0.5 bg-red-600 text-white px-2 py-0.5 rounded font-black text-[8px] animate-pulse">BREAK</span></span>`;
                    showStudioAlert(data.description);
                }
                editor.appendChild(div);
                const n = document.createElement('div');
                n.textContent = ln;
                nums.appendChild(n);
            });

            document.getElementById('btn-approve').disabled = false;
            document.getElementById('btn-reject').disabled = false;
        }

        function showStudioAlert(msg) {
            const box = document.getElementById('code-alert-box');
            document.getElementById('alert-text-body').innerText = msg;
            box.classList.remove('hidden');
            box.classList.add('flex');
            setTimeout(() => box.classList.remove('translate-y-10'), 100);
        }

        async function syncAuditTerminal() {
            const res = await fetch('/audit-logs');
            const data = await res.json();
            const feed = document.getElementById('audit-terminal-feed');
            feed.innerHTML = data.reverse().map(l => `
                <div class="flex gap-10 border-b border-white/5 pb-4 group">
                    <span class="text-zinc-700 shrink-0 font-bold uppercase truncate w-64">[${new Date(l.timestamp).toISOString()}]</span>
                    <span class="text-sky-500 font-black shrink-0 tracking-[2px] w-48">${l.event_type}</span>
                    <span class="text-zinc-500 group-hover:text-zinc-200 transition italic">>> ${l.description}</span>
                </div>
             `).join('');
        }

        async function syncComplianceReports() {
            const res = await fetch('/reports');
            const data = await res.json();
            const grid = document.getElementById('reports-grid');
            grid.innerHTML = data.map(r => `
                <div class="p-8 bg-zinc-900/50 rounded-[2rem] border border-white/5 group hover:bg-sky-500/10 transition duration-500">
                    <div class="flex justify-between items-start mb-10">
                        <div class="w-12 h-12 rounded-2xl bg-zinc-950 flex items-center justify-center border border-white/5">
                            <i data-lucide="file-check" class="text-sky-500 w-5 h-5"></i>
                        </div>
                        <span class="text-[9px] font-black text-sky-500 uppercase tracking-widest">${r.status}</span>
                    </div>
                    <h5 class="text-white font-black text-sm uppercase italic tracking-tight mb-4">${r.name}</h5>
                    <div class="flex justify-between items-end text-[10px] font-mono text-zinc-600">
                        <span>ID: ${r.id}</span>
                        <span>${r.size} | ${r.date}</span>
                    </div>
                </div>
            `).join('');
            lucide.createIcons();
        }

        async function syncNetworkTopology() {
            const res = await fetch('/network-topology');
            const data = await res.json();
            const map = document.getElementById('topology-map');
            map.innerHTML = `
                <div class="flex flex-col items-center gap-12 relative w-full">
                    <div class="grid grid-cols-2 lg:grid-cols-4 gap-12 w-full max-w-4xl relative z-10">
                        ${data.nodes.map(n => `
                            <div class="p-8 bg-zinc-950 rounded-3xl border border-white/10 flex flex-col items-center text-center group hover:border-sky-500 transition duration-500">
                                <div class="w-12 h-12 rounded-2xl bg-zinc-900 flex items-center justify-center mb-6 group-hover:bg-sky-500/10 transition">
                                    <i data-lucide="${n.type == 'Gateway' ? 'zap' : (n.type == 'Storage' ? 'database' : 'cpu')}" class="text-sky-500 w-5 h-5"></i>
                                </div>
                                <h6 class="text-white font-black text-[12px] uppercase italic mb-2">${n.id}</h6>
                                <p class="text-[9px] text-zinc-600 font-bold uppercase tracking-widest mb-4">${n.type}</p>
                                <div class="w-full h-1.5 bg-zinc-900 rounded-full overflow-hidden">
                                    <div class="h-full bg-sky-500" style="width: ${n.load}"></div>
                                </div>
                                <span class="text-[8px] font-mono text-zinc-700 mt-2 uppercase">Load: ${n.load}</span>
                            </div>
                        `).join('')}
                    </div>
                    <div class="absolute inset-0 flex items-center justify-center opacity-10 pointer-events-none">
                         <i data-lucide="activity" class="w-96 h-96"></i>
                    </div>
                </div>
            `;
            lucide.createIcons();
        }

        async function syncEngineSpecs() {
            const res = await fetch('/system/scanners');
            const data = await res.json();
            const grid = document.getElementById('engine-specs-grid');
            grid.innerHTML = data.scanners.map(s => `
                <div class="p-10 bg-zinc-900 border border-white/5 rounded-[3rem] group">
                    <div class="flex justify-between items-start mb-8">
                        <h5 class="text-white font-black text-xl italic uppercase tracking-tighter">${s.name}</h5>
                        <span class="px-3 py-1 bg-green-500/10 text-green-500 text-[10px] font-black rounded-lg uppercase tracking-widest">${s.status}</span>
                    </div>
                    <div class="space-y-3">
                        ${s.capabilities.map(c => `<div class="text-[11px] text-zinc-500 font-medium flex items-center gap-3"><div class="w-1.5 h-1.5 rounded-full bg-sky-500/40"></div> ${c}</div>`).join('')}
                    </div>
                    <div class="mt-10 pt-6 border-t border-white/5 text-[9px] font-bold text-zinc-700 uppercase tracking-[0.2em] group-hover:text-sky-500 transition">Autonomous Engine operational.</div>
                </div>
            `).join('');
            lucide.createIcons();
        }

        function updateForensicDetails() {
            if (selectedVulnObject) {
                document.getElementById('forensic-raw-data').innerText = JSON.stringify(selectedVulnObject, null, 4);
            }
        }

        // --- CORE SYSTEM ACTIONS ---
        async function runGlobalDiagnostic() {
            if (scanInProgress) return;
            scanInProgress = true;
            sendHUDToast("DIAGNOSTIC_QUEUE: Initiating local sector scan...", "info");

            const res = await fetch('/scan-trigger', { method: 'POST' });
            const data = await res.json();

            sendHUDToast(`CYBER_AUDIT_COMPLETE: Found ${data.found} vulnerable signatures.`, "success");
            await syncAllData();
            scanInProgress = false;
        }

        async function approveNeuralPatch() {
            if (!selectedVulnObject) return;
            sendHUDToast("DEPLOYING_REMEDIATION: Patching secure kernel...", "info");
            const res = await fetch(`/review/${selectedVulnObject.id}?action=approve`, { method: 'POST' });
            if (res.ok) {
                sendHUDToast("INTEGRITY_RESTORED: Source code successfully fixed.", "success");
                await syncAllData();
            }
        }

        async function rejectNeuralPatch() {
            if (!selectedVulnObject) return;
            const res = await fetch(`/review/${selectedVulnObject.id}?action=reject`, { method: 'POST' });
            if (res.ok) {
                sendHUDToast("ANOMALY_BYPASSED: Logic chain recalibrated.", "info");
                await syncAllData();
            }
        }

        // --- FAIL-SAFE HANDLERS ---
        function handleDataFailure() {
            failCount++;
            document.getElementById('retry-badge').classList.remove('hidden');
            if (failCount > 3) {
                document.getElementById('conn-lost').classList.remove('hidden');
            }
        }

        function startMainHeartbeat() {
            refreshSystemData = syncAllData; // Alias for heartbeat
            syncAllData();
            setInterval(syncAllData, 20000); // 20s cycle
        }

        function sendHUDToast(msg, type) {
            const container = document.getElementById('toast-container');
            const t = document.createElement('div');
            t.className = `p-6 bg-zinc-900 rounded-3xl border-l-[6px] ${type == 'success' ? 'border-sky-500' : (type == 'error' ? 'border-red-500' : 'border-zinc-700')} shadow-2xl animate-hud-toast pointer-events-auto`;
            t.innerHTML = `
                <div class="flex items-center gap-5">
                     <i data-lucide="${type == 'success' ? 'shield-check' : 'alert-circle'}" class="w-6 h-6 ${type == 'success' ? 'text-sky-500' : 'text-zinc-500'}"></i>
                     <div>
                        <p class="text-[10px] font-black uppercase tracking-widest text-zinc-600 mb-0.5 italic">SOC Message</p>
                        <p class="text-xs font-black text-white tracking-widest uppercase italic">${msg}</p>
                     </div>
                </div>
            `;
            container.appendChild(t);
            lucide.createIcons();
            setTimeout(() => {
                t.style.opacity = '0';
                t.style.transform = 'translateY(-20px) scale(0.95)';
                setTimeout(() => t.remove(), 500);
            }, 5000);
        }
    </script>
    <style>
        @keyframes hud-toast {
            from {
                opacity: 0;
                transform: translateY(20px) scale(0.95);
            }

            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .animate-hud-toast {
            animation: hud-toast 0.4s ease-out;
        }

        .animate-marquee {
            animation: marquee 50s linear infinite;
        }

        @keyframes marquee {
            0% {
                transform: translateX(100%);
            }

            100% {
                transform: translateX(-100%);
            }
        }
    </style>
</body>

</html>